(function(){/*
 OverlappingMarkerSpiderfier
https://github.com/jawj/OverlappingMarkerSpiderfier-Leaflet
Copyright (c) 2011 - 2012 George MacKerron
Released under the MIT licence: http://opensource.org/licenses/mit-license
Note: The Leaflet maps API must be included *before* this code
*/
(function(){var w={}.hasOwnProperty,x=[].slice;null!=this.L&&(this.OverlappingMarkerSpiderfier=function(){function u(a,b){this.map=a;null==b&&(b={});for(d in b)w.call(b,d)&&(a=b[d],this[d]=a);this.initMarkerArrays();this.listeners={};var c=["click","zoomend"];var d=0;for(a=c.length;d<a;d++)b=c[d],this.map.addEventListener(b,function(f){return function(){return f.unspiderfy()}}(this))}var g=u.prototype;g.VERSION="0.2.6";var r=2*Math.PI;g.keepSpiderfied=!1;g.nearbyDistance=20;g.circleSpiralSwitchover=
9;g.circleFootSeparation=25;g.circleStartAngle=r/12;g.spiralFootSeparation=28;g.spiralLengthStart=11;g.spiralLengthFactor=5;g.legWeight=1.5;g.legColors={usual:"#222",highlighted:"#f00"};g.initMarkerArrays=function(){this.markers=[];return this.markerListeners=[]};g.addMarker=function(a){if(null!=a._oms)return this;a._oms=!0;var b=function(c){return function(){return c.spiderListener(a)}}(this);a.addEventListener("click",b);this.markerListeners.push(b);this.markers.push(a);return this};g.getMarkers=
function(){return this.markers.slice(0)};g.removeMarker=function(a){null!=a._omsData&&this.unspiderfy();var b=this.arrIndexOf(this.markers,a);if(0>b)return this;var c=this.markerListeners.splice(b,1)[0];a.removeEventListener("click",c);delete a._oms;this.markers.splice(b,1);return this};g.clearMarkers=function(){var a,b;this.unspiderfy();var c=this.markers;var d=a=0;for(b=c.length;a<b;d=++a){var f=c[d];d=this.markerListeners[d];f.removeEventListener("click",d);delete f._oms}this.initMarkerArrays();
return this};g.addListener=function(a,b){var c;(null!=(c=this.listeners)[a]?c[a]:c[a]=[]).push(b);return this};g.removeListener=function(a,b){b=this.arrIndexOf(this.listeners[a],b);0>b||this.listeners[a].splice(b,1);return this};g.clearListeners=function(a){this.listeners[a]=[];return this};g.trigger=function(){var a,b;var c=arguments[0];var d=2<=arguments.length?x.call(arguments,1):[];c=null!=(a=this.listeners[c])?a:[];var f=[];var e=0;for(b=c.length;e<b;e++)a=c[e],f.push(a.apply(null,d));return f};
g.generatePtsCircle=function(a,b){var c,d;var f=this.circleFootSeparation*(2+a)/r;var e=r/a;var h=[];for(c=d=0;0<=a?d<a:d>a;c=0<=a?++d:--d)c=this.circleStartAngle+c*e,h.push(new L.Point(b.x+f*Math.cos(c),b.y+f*Math.sin(c)));return h};g.generatePtsSpiral=function(a,b){var c,d;var f=this.spiralLengthStart;var e=0;var h=[];for(c=d=0;0<=a?d<a:d>a;c=0<=a?++d:--d)e+=this.spiralFootSeparation/f+5E-4*c,c=new L.Point(b.x+f*Math.cos(e),b.y+f*Math.sin(e)),f+=r*this.spiralLengthFactor/e,h.push(c);return h};g.spiderListener=
function(a){var b,c;(b=null!=a._omsData)&&this.keepSpiderfied||this.unspiderfy();if(b)return this.trigger("click",a);var d=[];var f=[];var e=this.nearbyDistance*this.nearbyDistance;var h=this.map.latLngToLayerPoint(a.getLatLng());var k=this.markers;b=0;for(c=k.length;b<c;b++){var l=k[b];if(this.map.hasLayer(l)){var n=this.map.latLngToLayerPoint(l.getLatLng());this.ptDistanceSq(n,h)<e?d.push({marker:l,markerPt:n}):f.push(l)}}return 1===d.length?this.trigger("click",a):this.spiderfy(d,f)};g.makeHighlightListeners=
function(a){return{highlight:function(b){return function(){return a._omsData.leg.setStyle({color:b.legColors.highlighted})}}(this),unhighlight:function(b){return function(){return a._omsData.leg.setStyle({color:b.legColors.usual})}}(this)}};g.spiderfy=function(a,b){var c,d,f,e,h,k,l;this.spiderfying=!0;var n=a.length;var t=this.ptAverage(function(){var p;var q=[];var m=0;for(p=a.length;m<p;m++)h=a[m],q.push(h.markerPt);return q}());var v=n>=this.circleSpiralSwitchover?this.generatePtsSpiral(n,t).reverse():
this.generatePtsCircle(n,t);t=function(){var p;var q=[];var m=0;for(p=v.length;m<p;m++)d=v[m],c=this.map.layerPointToLatLng(d),l=this.minExtract(a,function(y){return function(z){return y.ptDistanceSq(z.markerPt,d)}}(this)),e=l.marker,f=new L.Polyline([e.getLatLng(),c],{color:this.legColors.usual,weight:this.legWeight,clickable:!1}),this.map.addLayer(f),e._omsData={usualPosition:e.getLatLng(),leg:f},this.legColors.highlighted!==this.legColors.usual&&(k=this.makeHighlightListeners(e),e._omsData.highlightListeners=
k,e.addEventListener("mouseover",k.highlight),e.addEventListener("mouseout",k.unhighlight)),e.setLatLng(c),e.setZIndexOffset(1E6),q.push(e);return q}.call(this);delete this.spiderfying;this.spiderfied=!0;return this.trigger("spiderfy",t,b)};g.unspiderfy=function(a){var b;null==a&&(a=null);if(null==this.spiderfied)return this;this.unspiderfying=!0;var c=[];var d=[];var f=this.markers;var e=0;for(b=f.length;e<b;e++){var h=f[e];if(null!=h._omsData){this.map.removeLayer(h._omsData.leg);h!==a&&h.setLatLng(h._omsData.usualPosition);
h.setZIndexOffset(0);var k=h._omsData.highlightListeners;null!=k&&(h.removeEventListener("mouseover",k.highlight),h.removeEventListener("mouseout",k.unhighlight));delete h._omsData;c.push(h)}else d.push(h)}delete this.unspiderfying;delete this.spiderfied;this.trigger("unspiderfy",c,d);return this};g.ptDistanceSq=function(a,b){var c=a.x-b.x;a=a.y-b.y;return c*c+a*a};g.ptAverage=function(a){var b,c,d;var f=c=d=0;for(b=a.length;f<b;f++){var e=a[f];c+=e.x;d+=e.y}a=a.length;return new L.Point(c/a,d/a)};
g.minExtract=function(a,b){var c,d;var f=c=0;for(d=a.length;c<d;f=++c){var e=a[f];e=b(e);if("undefined"===typeof k||null===k||e<h){var h=e;var k=f}}return a.splice(k,1)[0]};g.arrIndexOf=function(a,b){var c,d;if(null!=a.indexOf)return a.indexOf(b);var f=c=0;for(d=a.length;c<d;f=++c){var e=a[f];if(e===b)return f}return-1};return u}())}).call(this);}).call(this);
/* Wed Nov 15 22:38:39 EST 2023 */
